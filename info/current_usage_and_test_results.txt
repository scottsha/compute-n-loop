Eric:
cd Dropbox/compute-nloop/

# FORMAT OF NUMERICAL NZ DATUM

nz=load('nzdata/nz52a.sobj')
(
[ 1  0  1]  [1 0 0]                                 
[ 0  0 -1]  [0 1 0]                                 
[ 1 -1  0], [0 0 1], (1, 0, 0), (1, 1, 0), (0, 0, 0), [list of shapes...]
)
=(A, B, nu, f, f_ddot, list of numerical shapes)

# USAGE FOR NUMERICAL COMPUTATION OF N-LOOP INVARIANTS:

attach('nloop.py')
load('nloop.py')
all_diagrams = load('data_precomputed_diagrams/6diagrams.sobj')

nz52a = load('nzdata/nz52a.sobj')
nz52b = load('nzdata/nz52b.sobj')
S52a = nloop_invariant(nz52a,2,all_diagrams)
S52b = nloop_invariant(nz52b,2,all_diagrams)
[S52a,S52b,S52a-S52b]

S52a = nloop_invariant(nz52a,3,all_diagrams)
S52b = nloop_invariant(nz52b,3,all_diagrams)
[S52a,S52b,S52a-S52b]

S52a = nloop_invariant(nz52a,4,all_diagrams)
S52b = nloop_invariant(nz52b,4,all_diagrams)
[S52a,S52b,S52a-S52b]

nz61a = load('nzdata/nz61a.sobj')
nz61b = load('nzdata/nz61b.sobj')
S61a = nloop_invariant(nz61a,2,all_diagrams)
S61b = nloop_invariant(nz61b,2,all_diagrams)
[S61a, S61b, S61a-S61b]

S61a = nloop_invariant(nz61a,3,all_diagrams)
S61b = nloop_invariant(nz61b,3,all_diagrams)
[S61a, S61b, S61a-S61b]

S61a = nloop_invariant(nz61a,4,all_diagrams)
S61b = nloop_invariant(nz61b,4,all_diagrams)
[S61a, S61b, S61a-S61b]

S61a = nloop_invariant(nz61a,5,all_diagrams)
S61b = nloop_invariant(nz61b,5,all_diagrams)
[S61a, S61b, S61a-S61b]

nz62a = load('nzdata/nz62a.sobj')
nz62b = load('nzdata/nz62b.sobj')
S62a = nloop_invariant(nz62a,2,all_diagrams)
S62b = nloop_invariant(nz62b,2,all_diagrams)
[S62a, S62b, S62a-S62b]

S62a = nloop_invariant(nz62a,3,all_diagrams)
S62b = nloop_invariant(nz62b,3,all_diagrams)
[S62a, S62b, S62a-S62b]

S62a = nloop_invariant(nz62a,4,all_diagrams)
S62b = nloop_invariant(nz62b,4,all_diagrams)
[S62a, S62b, S62a-S62b]

RESULTS:

sage: S52a = nloop_invariant(nz52a,3,all_diagrams)
sage: S52b = nloop_invariant(nz52b,3,all_diagrams)
sage: [S52a,S52b,S52a-S52b]
[-0.0104379438258980624244230832853685227139290270086978304945409098050220874256016197755287909265129260572328548175917466600779904604084068068330598414163305747999853616370730942245327047174052334327963894015545776119413871417727237405315641942511631648119072096310695470640064522198034515935657737128476 - 0.0107446360281486840804273731151006194458986190657737951847148665396996919363116889238560377899654891519180414508573347693191815424838297158023472915140517252725803342573479711161526366129049152093157097026342633658176459879694355491066833610682884232302196099812433268591168868074544031539412293099398*I,
 -0.0104379438258980624244230832853685227139290270086978304945409098050220874256016197755287909265129260572328548175917466600779904604084068068330598414163305747999853616370730942245327047174052334327963894015545776119413871417727237405315641942511631648119072096310695470640064522198034515935657737128476 - 0.0107446360281486840804273731151006194458986190657737951847148665396996919363116889238560377899654891519180414508573347693191815424838297158023472915140517252725803342573479711161526366129049152093157097026342633658176459879694355491066833610682884232302196099812433268591168868074544031539412293099403*I,
 5.83289761564511799368805965452385731010682153982317515388571462372479319359859771534025204436175688974746868706452651640134679700846270246775950510752456722646506666336453218921246922491188644694437806747665695698900320321747458619253236419453384439881686486784016550699668633892913099513761039319027e-302 + 4.84130502098544793476108951325480156738866187805323537772514313769157835068683610373240919682025821849039901026355700861311784151702404304824038923924539079796600533059256171704634945667686575096383379600562527430087265867050390653980186228146309085101799784030733737080724966131117872596421662634792e-301*I]

sage: S52a=nloop_invariant(nz52a,4,all_diagrams)
sage: S52b=nloop_invariant(nz52b,4,all_diagrams)
sage: [S52a,S52b,S52a-S52b]
[0.00380993319683699 - 0.00175323407605732*I,
 0.00380993319683781 - 0.00175323407605813*I,
 -8.18789480661053e-16 + 8.17922118923065e-16*I]

sage: S61a = nloop_invariant(nz61a,3,all_diagrams)
sage: S61b = nloop_invariant(nz61b,3,all_diagrams)
sage: [S61a, S61b, S61a-S61b]
[-0.00403959914459695480161642643293641270762584553208703143337841302685367438388036183937367835768102081993907645742245999591719376234582798802069510465395947790434292640700433850326384249829275227944084526553896953546823123555165929427153891766073694886692188761856493201040837225423164928310332082062030 - 0.00916184824556319475244649136909066769568153430168437970009510383962158640889692715715613328814118810003756012136578848533458896902352618153579236724051147332555157770231325873656217731033274835834063156591436444243781833657047751174360880616178465263809572125642916353455425832520094951915409239482029*I,
 -0.00403959914459695480161642643293641270762584553208703143337841302685367438388036183937367835768102081993907645742245999591719376234582798802069510465395947790434292640700433850326384249829275227944084526553896953546823123555165929427153891766073694886692188761856493201040837225423164928310332082061782 - 0.00916184824556319475244649136909066769568153430168437970009510383962158640889692715715613328814118810003756012136578848533458896902352618153579236724051147332555157770231325873656217731033274835834063156591436444243781833657047751174360880616178465263809572125642916353455425832520094951915409239481839*I,
 -2.47752326224526386781900333825900839246787244903989364661295728642710590898100437959077205584265623892023732483065763784147205202934453287318084979442105992944103706526408504736799630328132376833962458416071004248107911056662233048527812169162825040839746335261511029909684252246014839018470001450757e-300 - 1.90735752031595358393599550702930134040493064352217827532062868195800737430674145291626241850629450294742226067010017086324040262176730370695735817016053348305407679892020202587247743654618686815081162806486682493540404745211418968495808309161256711841311481178373412078791643282982583540999859857322e-300*I]

sage: S61a = nloop_invariant(nz61a,4,all_diagrams)
sage: S61b = nloop_invariant(nz61b,4,all_diagrams)
sage: [S61a, S61b, S61a-S61b]
[0.00123080914629776717934400672140767196811711056256680213064743063399043080839598506540537615349411649107824893173514966299552400354704688535172350573473029772583656238215357156540282276492039557798673198988749149107221071382979669528113703895850579214942194260788822143662873932794138404510976359020276 - 0.000596277622585702762344101705598257315396352847781092471072249807453797613953035536636693869446686971356288915461973621141270213324693894494135511489624727498260491085329981313624594221172393019579116732722781159408075041573956389066238495599170785388193407596038852409948165733883149113195383324922576*I,
 0.00123080914629776717934400672140767196811711056256680213064743063399043080839598506540537615349411649107824893173514966299552400354704688535172350573473029772583656238215357156540282276492039557798673198988749149107221071382979669528113703895850579214942194260788822143662873932794138404510976359009401 - 0.000596277622585702762344101705598257315396352847781092471072249807453797613953035536636693869446686971356288915461973621141270213324693894494135511489624727498260491085329981313624594221172393019579116732722781159408075041573956389066238495599170785388193407596038852409948165733883149113195383325335627*I,
 1.08751459594895402433317028228770057618286634199233189156622206302036906698049055103661329241102776330896679935974564635044910356824282856160142092977241793653827935405100020401771882463869666860054456879068530634581470222388204922266669664224986261893741037028445965795199718446164182838843176975836e-298 + 4.13050811754293385605026256375452431557904460521038325347262995364447505211491098614104608269433452390577247605787380732444972083357277812551921594684244703574897230699495982446891795692910326853919188470291985752219272832642245346637986838071719657257817468751233480212463346404927482289674742383376e-298*I]

sage: S62a = nloop_invariant(nz62a,3,all_diagrams)
sage: S62b = nloop_invariant(nz62b,3,all_diagrams)
sage: [S62a, S62b, S62a-S62b]
[-0.00786472989571506 + 0.0218873762586470*I,
 -0.00786472989571474 + 0.0218873762586435*I,
 -3.19189119579733e-16 + 3.46944695195361e-15*I]

sage: S62a = nloop_invariant(nz62a,4,all_diagrams)
sage: S62b = nloop_invariant(nz62b,4,all_diagrams)
sage: [S62a, S62b, S62a-S62b]
[-0.00807303838302114 + 0.00202974131799239*I,
 -0.00807303838303537 + 0.00202974131797151*I,
 1.42316713969137e-14 + 2.08817338420708e-14*I]


# FORMAT OF NZ DATUM FOR EXACT COMPUTATION OF N-LOOP INVARIANTS

sage: nz=load(â€˜nz_exact_52a.sobj')
sage: nz
(
[ 0 -1  1]  [1 0 0]                                 
[-1  0  0]  [0 1 0]                                 
[ 1  0  1], [0 0 1], (0, 0, 1), (0, 1, 1), (0, 0, 0),

x^3 + 2*x^2 + 3*x + 1, [-y, y^2 + y + 2, -y^2 - 2*y - 2]
)
= (A,B,nu,f,fdot, polynomial of the number field K, list of shapes in K).

So,

K = NumberField(x^3 + 2*x^2 + 3*x + 1,'x')
x = K.gen()
R = LaurentPolynomialRing(K,'h')
h = R.gen()

# USAGE FOR EXACT COMPUTATION OF N-LOOP INVARIANTS

attach('nloop_exact.py')
load('nloop_exact.py')
all_diagrams = load('data_precomputed_diagrams/6diagrams.sobj')

# 4_1

nz = load('nzdata/nz_exact_41.sobj')

v = [nloop_invariant(nz,n,all_diagrams) for n in range(2,6)]
[-11/108*y + 1/108,
-1/54,
1081/87480*y - 1081/174960,
49/5832,
-110011/11022480*y + 110011/22044960]

# 5_2

nz = load('nzdata/nz_exact_52.sobj')

v = [nloop_invariant(nz,n,all_diagrams) for n in range(2,6)]

[121/1058*y^2 + 209/2116*y + 2195/12696,
465/24334*y^2 + 465/12167*y + 492/12167,
11023/308944464*y^2 + 2158417/1544722320*y + 954961/193090290,
-1539461/1184287112*y^2 - 14383/6436343*y - 910621/296071778,
-2949170939353/789374731632480*y^2 - 5217424367963/789374731632480*y - 776263588913/98671841454060,
694694103338429/161663945038331904*y^2 - 270341894845373/26943990839721984*y + 16556466413701/1924570774265856
]

# (-2,3,7) pretzel

nz = load('nzdata/nz_exact_52.sobj')

v = [nloop_invariant(nz,n,all_diagrams) for n in range(2,6)]

[-127/2116*y^2 + 801/8464*y - 1189/8464,
2099/778688*y^2 + 4775/778688*y + 2099/389344,
15544063/4943111424*y^2 + 105255847/16477038080*y - 250975789/98862228480,
1117613153/227383125504*y^2 - 2222937179/454766251008*y - 5001630733/1819065004032
]

# 6_1 

nz = load('nzdata/nz_exact_61.sobj')

v = [nloop_invariant(nz,n,all_diagrams) for n in range(2,6)]

[-46490/198147*y^3 + 231209/396294*y^2 - 473191/792588*y - 62777/264196,
-570416/16974593*y^3 + 2833463/33949186*y^2 - 1122215/16974593*y - 1386486/16974593,
2255130587026/50451970187565*y^3 - 91695358340911/807231523001040*y^2 + 85651263871967/807231523001040*y + 1596902056811/20180788075026,
37040877003091/1728820845093894*y^3 - 330280282463219/6915283380375576*y^2 + 53499149965837/1728820845093894*y + 72838757049049/1152547230062596]

# 6_2

nz = load('nzdata/nz_exact_61.sobj')

v = [nloop_invariant(nz,n,all_diagrams) for n in range(2,6)]

# COMPARISON OF EXACT COMPUTATIONS FOR DIFFERENT TRIANGULATIONS

nz62a = load('nzdata/nz_exact_62.sobj')
nz62b = load('nzdata/nz_exact_62can.sobj')

S62a = nloop_invariant(nz62a,2,all_diagrams)
S62b = nloop_invariant(nz62b,2,all_diagrams)
[S62a,S62b,S62a-S62b]
TypeError: unsupported operand parent(s) for '-': 'Number Field in y with defining polynomial x^5 - 2*x^4 - x^3 + 4*x^2 + 4*x + 1' and 'Number Field in y with defining polynomial x^5 - 4*x^3 + 5*x^2 - 2*x + 1'

result62 = (3115795/18946374*y^4 - 17715035/37892748*y^3 + 
     9243497/37892748*y^2 + 5397211/9473187*y - 868091/18946374) /. 
   y -> (1.87448071640369012030697010201291748883755282956644636320146\
380061066203730871`50.09795030376352 + 
      0.98098678589161454655106512497280839062646528469200898461853805\
853078765886706`49.81673248413559 I);
result62can = (-15665303/189463740*y^4 + 973649/47365935*y^3 + 
     8042041/18946374*y^2 - 13515617/37892748*y - 
     21516891/126309160) /. 
   y -> (1.14227249656265454324398356541512500277575302429558557864524\
406618479092377688`50.11117466814593 + 
      0.50907129831817022065080919653841036395546025340050692680380705\
36084924405021`49.76018356009022 I);
result62 - result62can
0.041666666666666666666666666666666666666666666667 + 0.*10^-49 I
